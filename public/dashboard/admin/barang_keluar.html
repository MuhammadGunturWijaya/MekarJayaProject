<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barang Keluar - Mekar Jaya</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0c4a6e 0%, #0e7490 50%, #06b6d4 100%);
            background-attachment: fixed;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: linear-gradient(180deg, #164e63 0%, #0e7490 100%);
            padding: 25px 20px;
            z-index: 1000;
            transition: transform 0.3s ease;
            overflow-y: auto;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.2);
        }

        .sidebar.hidden {
            transform: translateX(-100%);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 15px;
            margin-bottom: 35px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-section .icon {
            font-size: 36px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .logo-section h2 {
            color: white;
            font-size: 22px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .logo-section .badge {
            background: linear-gradient(135deg, #22d3ee, #06b6d4);
            color: white;
            font-size: 10px;
            padding: 4px 10px;
            border-radius: 8px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(34, 211, 238, 0.4);
        }

        .menu-section {
            margin-bottom: 30px;
        }

        .menu-label {
            color: rgba(255, 255, 255, 0.5);
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 15px;
            margin-bottom: 12px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 18px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 15px;
            margin-bottom: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            font-size: 15px;
            position: relative;
        }

        .menu-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 0;
            background: linear-gradient(180deg, #22d3ee, #06b6d4);
            border-radius: 0 4px 4px 0;
            transition: height 0.3s ease;
        }

        .menu-item:hover::before {
            height: 60%;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: translateX(5px);
        }

        .menu-item.active {
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.3), rgba(6, 182, 212, 0.2));
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(34, 211, 238, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .menu-item.active::before {
            height: 60%;
        }

        .menu-item .icon {
            font-size: 22px;
            width: 28px;
            text-align: center;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .menu-item .badge {
            margin-left: auto;
            background: linear-gradient(135deg, #f43f5e, #e11d48);
            color: white;
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(244, 63, 94, 0.4);
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 25px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 25px 30px;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .header-left h1 {
            background: linear-gradient(135deg, #0c4a6e, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 28px;
            margin-bottom: 6px;
            font-weight: 800;
        }

        .header-left p {
            color: #64748b;
            font-size: 15px;
        }

        .header-right {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-box {
            position: relative;
            display: flex;
        }

        .search-box input {
            padding: 12px 18px 12px 45px;
            border: 2px solid rgba(14, 116, 144, 0.2);
            border-radius: 15px;
            width: 240px;
            font-size: 14px;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.9);
        }

        .search-box input:focus {
            outline: none;
            border-color: #0e7490;
            box-shadow: 0 0 0 4px rgba(14, 116, 144, 0.1);
            background: white;
        }

        .search-box .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            pointer-events: none;
        }

        .menu-toggle {
            display: none;
            background: linear-gradient(135deg, #0e7490, #06b6d4);
            border: none;
            color: white;
            padding: 12px 18px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 20px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #0e7490, #06b6d4);
            color: white;
            box-shadow: 0 4px 12px rgba(14, 116, 144, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(14, 116, 144, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.9);
            color: #0c4a6e;
            border: 2px solid rgba(14, 116, 144, 0.2);
        }

        .btn-secondary:hover {
            background: white;
            border-color: #0e7490;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #f43f5e, #e11d48);
            color: white;
            box-shadow: 0 4px 12px rgba(244, 63, 94, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-2px);
        }

        /* Filter Section */
        .filter-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-size: 13px;
            font-weight: 600;
            color: #0c4a6e;
            margin-bottom: 8px;
        }

        .filter-input,
        .filter-select {
            padding: 10px 12px;
            border: 2px solid rgba(14, 116, 144, 0.2);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
            background: white;
        }

        .filter-input:focus,
        .filter-select:focus {
            outline: none;
            border-color: #0e7490;
            box-shadow: 0 0 0 4px rgba(14, 116, 144, 0.1);
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* Table */
        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.5);
            margin-bottom: 25px;
        }

        .table-header {
            padding: 20px;
            border-bottom: 1px solid rgba(14, 116, 144, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h3 {
            color: #0c4a6e;
            font-size: 18px;
            font-weight: 800;
        }

        .table-actions {
            display: flex;
            gap: 10px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead {
            background: linear-gradient(135deg, rgba(14, 116, 144, 0.1), rgba(6, 182, 212, 0.1));
        }

        .data-table th {
            padding: 15px 12px;
            text-align: left;
            font-size: 12px;
            font-weight: 700;
            color: #0c4a6e;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid rgba(14, 116, 144, 0.1);
        }

        .data-table tbody tr {
            transition: all 0.3s;
            border-bottom: 1px solid rgba(14, 116, 144, 0.05);
        }

        .data-table tbody tr:hover {
            background: rgba(14, 116, 144, 0.05);
        }

        .data-table tbody tr:last-child {
            border-bottom: none;
        }

        .data-table td {
            padding: 15px 12px;
            font-size: 14px;
            color: #475569;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            display: inline-block;
        }

        .status-badge.success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));
            color: #059669;
        }

        .status-badge.warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(217, 119, 6, 0.2));
            color: #d97706;
        }

        .status-badge.danger {
            background: linear-gradient(135deg, rgba(244, 63, 94, 0.2), rgba(225, 29, 72, 0.2));
            color: #e11d48;
        }

        .action-btn {
            background: rgba(14, 116, 144, 0.1);
            border: none;
            padding: 6px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            margin: 0 2px;
        }

        .action-btn:hover {
            background: linear-gradient(135deg, #0e7490, #06b6d4);
            transform: scale(1.1);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-top: 1px solid rgba(14, 116, 144, 0.1);
        }

        .pagination-info {
            color: #64748b;
            font-size: 13px;
        }

        .pagination-controls {
            display: flex;
            gap: 8px;
        }

        .pagination-btn {
            padding: 8px 12px;
            border: 1px solid rgba(14, 116, 144, 0.2);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
        }

        .pagination-btn:hover {
            background: rgba(14, 116, 144, 0.1);
            border-color: #0e7490;
        }

        .pagination-btn.active {
            background: linear-gradient(135deg, #0e7490, #06b6d4);
            color: white;
            border-color: #0e7490;
        }

        .pagination-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(12, 74, 110, 0.7);
            backdrop-filter: blur(5px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(14, 116, 144, 0.1);
        }

        .modal-header h3 {
            color: #0c4a6e;
            font-size: 22px;
            font-weight: 800;
            margin: 0;
        }

        .close-modal {
            background: rgba(244, 63, 94, 0.1);
            border: none;
            padding: 10px 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            color: #e11d48;
        }

        .close-modal:hover {
            background: rgba(244, 63, 94, 0.2);
            transform: scale(1.1) rotate(90deg);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #0c4a6e;
            margin-bottom: 8px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(14, 116, 144, 0.2);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
            background: white;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #0e7490;
            box-shadow: 0 0 0 4px rgba(14, 116, 144, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-full {
            grid-column: 1 / -1;
        }

        .product-items {
            margin-top: 10px;
        }

        .product-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1.2fr 1.2fr auto;
            gap: 10px;
            padding: 12px;
            background: rgba(14, 116, 144, 0.05);
            border-radius: 8px;
            margin-bottom: 10px;
            align-items: center;
        }

        .add-product-btn {
            background: rgba(14, 116, 144, 0.1);
            border: 2px dashed rgba(14, 116, 144, 0.3);
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            color: #0e7490;
            font-weight: 600;
            transition: all 0.3s;
            margin-top: 10px;
            width: 100%;
        }

        .add-product-btn:hover {
            background: rgba(14, 116, 144, 0.2);
            border-color: #0e7490;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px solid rgba(14, 116, 144, 0.1);
        }

        /* Overlay */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(12, 74, 110, 0.7);
            backdrop-filter: blur(5px);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            inset: 0;
            display: none;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(8px);
            z-index: 9999;
        }

        .loading-overlay.active {
            display: flex;
        }

        .dots-loader {
            background: linear-gradient(120deg, rgba(90, 167, 255, 0.35), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(20px);
            padding: 35px 55px;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 30px rgba(90, 167, 255, 0.35), 0 12px 40px rgba(0, 0, 0, 0.15);
            text-align: center;
        }

        .dots {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
        }

        .dots span {
            width: 12px;
            height: 12px;
            background: #7b5dfc;
            border-radius: 50%;
            animation: pulseDots 1.2s infinite ease-in-out;
            box-shadow: 0 0 10px rgba(123, 93, 252, 0.6);
        }

        .dots span:nth-child(1) {
            animation-delay: 0s;
        }

        .dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes pulseDots {
            0% {
                transform: scale(0.6);
                opacity: 0.5;
            }

            40% {
                transform: scale(1.2);
                opacity: 1;
            }

            100% {
                transform: scale(0.6);
                opacity: 0.5;
            }
        }

        .loading-title {
            font-size: 14px;
            color: #444;
            letter-spacing: 1px;
            margin: 0;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 18px;
            }

            .menu-toggle {
                display: block;
            }

            .header {
                flex-direction: column;
                gap: 18px;
                padding: 20px;
            }

            .header-left {
                width: 100%;
            }

            .header-right {
                width: 100%;
                justify-content: space-between;
            }

            .search-box {
                flex: 1;
            }

            .search-box input {
                width: 100%;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .product-item {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 12px;
            }

            .header-left h1 {
                font-size: 22px;
            }

            .table-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .table-actions {
                width: 100%;
                justify-content: space-between;
            }

            .pagination {
                flex-direction: column;
                gap: 15px;
            }

            .modal-content {
                padding: 20px;
            }
        }

        .logout-modal {
            position: fixed;
            inset: 0;
            background: rgba(12, 74, 110, 0.7);
            backdrop-filter: blur(6px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .logout-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .logout-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 35px;
            border-radius: 25px;
            text-align: center;
            width: 350px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        .logout-icon {
            font-size: 55px;
            margin-bottom: 15px;
        }

        .logout-box h3 {
            color: #0c4a6e;
            font-size: 20px;
            margin-bottom: 10px;
        }

        .logout-box p {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 25px;
        }

        .logout-actions {
            display: flex;
            gap: 10px;
        }

        .logout-actions button {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: 0.3s;
        }

        .btn-cancel {
            background: rgba(148, 163, 184, 0.2);
            color: #475569;
        }

        .btn-cancel:hover {
            background: rgba(148, 163, 184, 0.4);
        }

        .btn-confirm {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-confirm:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.5);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(40px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .logout-modal {
            position: fixed;
            inset: 0;
            background: rgba(12, 74, 110, 0.7);
            backdrop-filter: blur(6px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .logout-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .logout-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 35px;
            border-radius: 25px;
            text-align: center;
            width: 350px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        .logout-icon {
            font-size: 55px;
            margin-bottom: 15px;
        }

        .logout-box h3 {
            color: #0c4a6e;
            font-size: 20px;
            margin-bottom: 10px;
        }

        .logout-box p {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 25px;
        }

        .logout-actions {
            display: flex;
            gap: 10px;
        }

        .logout-actions button {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: 0.3s;
        }

        .btn-cancel {
            background: rgba(148, 163, 184, 0.2);
            color: #475569;
        }

        .btn-cancel:hover {
            background: rgba(148, 163, 184, 0.4);
        }

        .btn-confirm {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-confirm:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.5);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(40px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="overlay" id="overlay"></div>

    <aside class="sidebar" id="sidebar">
        <div class="logo-section">
            <span class="icon">üé£</span>
            <div>
                <h2>Mekar Jaya</h2>
                <span class="badge">ADMIN</span>
            </div>
        </div>
        <a href="../admin/kasir.html" class="menu-item" data-loading="true">
            <span class="icon">üñ•Ô∏è</span><span>Kasir</span>
        </a>
        <div class="menu-section">
            <div class="menu-label">Menu Utama</div>
            <a href="../admin/dashboard.html" class="menu-item" data-loading="true">
                <span class="icon">üìä</span><span>Dashboard</span>
            </a>
            <a href="../admin/master_data.html" class="menu-item" data-loading="true">
                <span class="icon">üßæ</span><span>Master Data</span>
            </a>
            <a href="../admin/barang_masuk.html" class="menu-item" data-loading="true">
                <span class="icon">üöö</span><span>Barang Masuk</span>
            </a>
            <a href="../admin/barang_keluar.html" class="menu-item active" data-loading="true">
                <span class="icon">üì¶</span><span>Barang Keluar</span>
            </a>
            <a href="../admin/generate_laporan.html" class="menu-item" data-loading="true">
                <span class="icon">üìù</span><span>Generate Laporan</span>
            </a>
            <a href="../admin/riwayat_transaksi.html" class="menu-item" data-loading="true">
                <span class="icon">üìú</span><span>Riwayat Transaksi</span>
            </a>
        </div>
        <div class="menu-section">
            <div class="menu-label">Manajemen</div>
            <a href="../admin/pengaturan.html" class="menu-item" data-loading="true">
                <span class="icon">‚öôÔ∏è</span><span>Pengaturan</span>
            </a>
            <a href="#" class="menu-item logout-btn">
                <span class="icon">üö™</span><span>Logout</span>
            </a>
        </div>
    </aside>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="dots-loader">
            <div class="dots"><span></span><span></span><span></span></div>
            <p class="loading-title">Loading...</p>
        </div>
    </div>

    <main class="main-content" id="mainContent">
        <div class="header">
            <div class="header-left">
                <h1>Manajemen Barang Keluar</h1>
                <p>Kelola pengeluaran barang dari gudang</p>
            </div>
            <div class="header-right">
                <button class="menu-toggle" id="menuToggle">‚ò∞</button>
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInput" placeholder="Cari barang keluar...">
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-primary" id="addOutgoingBtn">
                <span>‚ûï</span> Tambah Barang Keluar
            </button>
            <button class="btn btn-secondary" id="printBtn">
                <span>üñ®Ô∏è</span> Cetak Laporan
            </button>
            <button class="btn btn-danger" id="deleteSelectedBtn">
                <span>üóëÔ∏è</span> Hapus Terpilih
            </button>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label">Tanggal Mulai</label>
                    <input type="date" class="filter-input" id="startDate">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Tanggal Akhir</label>
                    <input type="date" class="filter-input" id="endDate">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Status</label>
                    <select class="filter-select" id="statusFilter">
                        <option value="all">Semua Status</option>
                        <option value="completed">Selesai</option>
                        <option value="pending">Pending</option>
                        <option value="cancelled">Dibatalkan</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Tujuan</label>
                    <select class="filter-select" id="destinationFilter">
                        <option value="all">Semua Tujuan</option>
                        <option value="penjualan">Penjualan</option>
                        <option value="transfer_gudang">Transfer Gudang</option>
                        <option value="sample">Sample/Display</option>
                        <option value="retur">Retur Supplier</option>
                        <option value="lainnya">Lainnya</option>
                    </select>
                </div>
            </div>
            <div class="filter-actions">
                <button class="btn btn-primary" id="applyFilter">Terapkan Filter</button>
                <button class="btn btn-secondary" id="resetFilter">Reset Filter</button>
            </div>
        </div>

        <!-- Table -->
        <div class="table-container">
            <div class="table-header">
                <h3>Daftar Barang Keluar</h3>
                <div class="table-actions">
                    <select class="filter-select" id="rowsPerPage">
                        <option value="10">10 baris</option>
                        <option value="25">25 baris</option>
                        <option value="50">50 baris</option>
                    </select>
                    <button class="btn btn-secondary" id="refreshBtn">üîÑ Refresh</button>
                </div>
            </div>

            <div style="overflow-x: auto;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th style="width: 30px;"><input type="checkbox" id="selectAll"></th>
                            <th>ID Transaksi</th>
                            <th>Tanggal</th>
                            <th>Alamat</th>
                            <th>Tujuan</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Petugas</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="outgoingTableBody">
                    </tbody>
                </table>
            </div>

            <div class="pagination">
                <div class="pagination-info" id="paginationInfo">Menampilkan 0 item</div>
                <div class="pagination-controls" id="paginationControls"></div>
            </div>
        </div>

        <!-- Modal Tambah/Edit Barang Keluar -->
        <div class="modal-overlay" id="outgoingModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Tambah Barang Keluar</h3>
                    <button class="close-modal" id="closeModal">‚úï</button>
                </div>

                <form id="outgoingForm">
                    <input type="hidden" id="editIndex" value="-1">

                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Tanggal Keluar *</label>
                            <input type="datetime-local" class="form-input" id="outgoingDate" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">No. Transaksi *</label>
                            <input type="text" class="form-input" id="transactionId" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tujuan *</label>
                            <select class="form-select" id="destination" required>
                                <option value="">Pilih Tujuan</option>
                                <option value="penjualan">Penjualan</option>
                                <option value="transfer_gudang">Transfer Gudang</option>
                                <option value="sample">Sample/Display</option>
                                <option value="retur">Retur Supplier</option>
                                <option value="lainnya">Lainnya</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Keterangan Tujuan</label>
                            <input type="text" class="form-input" id="destinationNote"
                                placeholder="Contoh: Toko Mekar Jaya Cabang Surabaya">
                        </div>
                        <div class="form-group form-full">
                            <label class="form-label">Alamat *</label>
                            <input type="text" class="form-input" id="addressInput"
                                placeholder="Masukkan alamat tujuan lengkap" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Barang yang Dikeluarkan *</label>
                        <div class="product-items" id="productItems"></div>
                        <button type="button" class="add-product-btn" id="addProductBtn">
                            + Tambah Barang
                        </button>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Petugas *</label>
                            <select class="form-select" id="officer" required>
                                <option value="">Pilih Petugas</option>
                                <option value="Admin Mekar Jaya">Admin Mekar Jaya</option>
                                <option value="Budi Santoso">Budi Santoso</option>
                                <option value="Siti Nurhaliza">Siti Nurhaliza</option>
                                <option value="Ahmad Rizki">Ahmad Rizki</option>
                                <option value="Dewi Rahayu">Dewi Rahayu</option>
                                <option value="Hendra Wijaya">Hendra Wijaya</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status *</label>
                            <select class="form-select" id="status" required>
                                <option value="pending">Pending</option>
                                <option value="completed">Selesai</option>
                                <option value="cancelled">Dibatalkan</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Catatan</label>
                        <textarea class="form-textarea" id="notes"
                            placeholder="Tambahkan catatan jika diperlukan..."></textarea>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancelBtn">Batal</button>
                        <button type="submit" class="btn btn-primary" id="saveBtn">Simpan Barang Keluar</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script>
        // ===== DATA =====
        let outgoingData = [
            {
                id: 'BK-2024-001',
                date: '2024-01-15T14:30',
                items: [
                    { productId: 1, name: 'Joran Carbon Pro X1', quantity: 5, unit: 'pcs', price: 850000 }
                ],
                destination: 'penjualan',
                destinationNote: 'Toko Mekar Jaya Cabang Surabaya',
                address: 'Jl. Raya Darmo No. 45, Surabaya, Jawa Timur 60241',
                status: 'completed',
                officer: 'Admin Mekar Jaya',
                notes: 'Pengiriman reguler'
            },
            {
                id: 'BK-2024-002',
                date: '2024-01-14T10:15',
                items: [
                    { productId: 2, name: 'Reel Shimano 5000', quantity: 3, unit: 'pcs', price: 1250000 },
                    { productId: 3, name: 'Umpan Set Premium', quantity: 10, unit: 'set', price: 75000 }
                ],
                destination: 'transfer_gudang',
                destinationNote: 'Gudang Pusat Jakarta',
                address: 'Jl. Industri Raya No. 12, Cakung, Jakarta Timur 13910',
                status: 'completed',
                officer: 'Budi Santoso',
                notes: 'Transfer stok'
            },
            {
                id: 'BK-2024-003',
                date: '2024-01-13T09:30',
                items: [
                    { productId: 4, name: 'Tas Pancing Waterproof', quantity: 2, unit: 'pcs', price: 320000 }
                ],
                destination: 'sample',
                destinationNote: 'Display Showroom',
                address: 'Jl. Ahmad Yani No. 88, Jember, Jawa Timur 68131',
                status: 'pending',
                officer: 'Siti Nurhaliza',
                notes: 'Untuk display promosi'
            },
            {
                id: 'BK-2024-004',
                date: '2024-01-12T16:45',
                items: [
                    { productId: 6, name: 'Kail Set Professional', quantity: 8, unit: 'set', price: 95000 }
                ],
                destination: 'retur',
                destinationNote: 'Supplier PT. Pancing Jaya',
                address: 'Jl. Gatot Subroto No. 33, Bandung, Jawa Barat 40262',
                status: 'completed',
                officer: 'Admin Mekar Jaya',
                notes: 'Barang cacat produksi'
            },
            {
                id: 'BK-2024-005',
                date: '2024-01-11T11:20',
                items: [
                    { productId: 1, name: 'Joran Carbon Pro X1', quantity: 2, unit: 'pcs', price: 850000 },
                    { productId: 2, name: 'Reel Shimano 5000', quantity: 2, unit: 'pcs', price: 1250000 },
                    { productId: 4, name: 'Tas Pancing Waterproof', quantity: 1, unit: 'pcs', price: 320000 }
                ],
                destination: 'penjualan',
                destinationNote: 'Pelanggan Corporate - PT. Maju Jaya',
                address: 'Jl. Sudirman Kav. 52-53, Jakarta Selatan 12190',
                status: 'completed',
                officer: 'Ahmad Rizki',
                notes: 'Pesanan khusus dengan diskon 10%'
            }
        ];

        const availableProducts = [
            { id: 1, name: 'Joran Carbon Pro X1', stock: 25, unit: 'pcs', price: 850000 },
            { id: 2, name: 'Reel Shimano 5000', stock: 42, unit: 'pcs', price: 1250000 },
            { id: 3, name: 'Umpan Set Premium', stock: 8, unit: 'set', price: 75000 },
            { id: 4, name: 'Tas Pancing Waterproof', stock: 31, unit: 'pcs', price: 320000 },
            { id: 5, name: 'Pelampung Pancing', stock: 22, unit: 'pcs', price: 45000 },
            { id: 6, name: 'Kail Set Professional', stock: 14, unit: 'set', price: 95000 },
            { id: 7, name: 'Line Pancing 100m', stock: 15, unit: 'roll', price: 130000 },
            { id: 8, name: 'Box Pancing Portable', stock: 7, unit: 'pcs', price: 275000 }
        ];

        function formatRupiah(amount) {
            return 'Rp ' + Number(amount).toLocaleString('id-ID');
        }

        function calcItemTotal(items) {
            return items.reduce((sum, i) => sum + (i.price * i.quantity), 0);
        }

        // Pagination & filter state
        let currentPage = 1;
        let rowsPerPage = 10;
        let filteredData = [...outgoingData];

        // ===== HELPERS =====
        function formatDestination(dest) {
            const map = {
                penjualan: 'Penjualan',
                transfer_gudang: 'Transfer Gudang',
                sample: 'Sample/Display',
                retur: 'Retur Supplier',
                lainnya: 'Lainnya'
            };
            return map[dest] || dest;
        }

        function formatStatus(status) {
            if (status === 'completed') return '<span class="status-badge success">Selesai</span>';
            if (status === 'pending') return '<span class="status-badge warning">Pending</span>';
            return '<span class="status-badge danger">Dibatalkan</span>';
        }

        function generateId() {
            const year = new Date().getFullYear();
            const max = outgoingData.reduce((m, d) => {
                const num = parseInt(d.id.split('-')[2]) || 0;
                return Math.max(m, num);
            }, 0);
            return `BK-${year}-${String(max + 1).padStart(3, '0')}`;
        }

        // ===== FILTER =====
        function applyFilters() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const status = document.getElementById('statusFilter').value;
            const destination = document.getElementById('destinationFilter').value;
            const search = document.getElementById('searchInput').value.toLowerCase();

            filteredData = outgoingData.filter(item => {
                const itemDate = item.date.split('T')[0];

                if (startDate && itemDate < startDate) return false;
                if (endDate && itemDate > endDate) return false;
                if (status !== 'all' && item.status !== status) return false;
                if (destination !== 'all' && item.destination !== destination) return false;

                if (search) {
                    const matchId = item.id.toLowerCase().includes(search);
                    const matchAddr = item.address.toLowerCase().includes(search);
                    const matchOfficer = item.officer.toLowerCase().includes(search);
                    const matchDest = formatDestination(item.destination).toLowerCase().includes(search);
                    const matchNote = (item.destinationNote || '').toLowerCase().includes(search);
                    if (!matchId && !matchAddr && !matchOfficer && !matchDest && !matchNote) return false;
                }

                return true;
            });

            currentPage = 1;
            renderTable();
        }

        // ===== TABLE RENDER =====
        function renderTable() {
            const tbody = document.getElementById('outgoingTableBody');
            tbody.innerHTML = '';

            const total = filteredData.length;
            const totalPages = Math.max(1, Math.ceil(total / rowsPerPage));
            if (currentPage > totalPages) currentPage = totalPages;

            const start = (currentPage - 1) * rowsPerPage;
            const end = Math.min(start + rowsPerPage, total);
            const pageData = filteredData.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = `<tr><td colspan="9" style="text-align:center;padding:30px;color:#94a3b8;">Tidak ada data barang keluar</td></tr>`;
            } else {
                pageData.forEach((item) => {
                    const realIndex = outgoingData.indexOf(item);
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><input type="checkbox" class="row-checkbox" data-id="${item.id}"></td>
                        <td><strong>${item.id}</strong></td>
                        <td>${item.date.replace('T', ' ')}</td>
                        <td style="max-width:180px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;" title="${item.address}">${item.address}</td>
                        <td>${formatDestination(item.destination)}</td>
                        <td><strong style="color:#059669;">${formatRupiah(calcItemTotal(item.items))}</strong></td>
                        <td>${formatStatus(item.status)}</td>
                        <td>${item.officer}</td>
                        <td>
                            <button class="action-btn view-btn" data-index="${realIndex}" title="Lihat Detail">üëÅÔ∏è</button>
                            <button class="action-btn edit-btn" data-index="${realIndex}" title="Edit">‚úèÔ∏è</button>
                            <button class="action-btn delete-btn" data-index="${realIndex}" title="Hapus">üóëÔ∏è</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });

                // Grand total row
                const grandTotal = pageData.reduce((sum, item) => sum + calcItemTotal(item.items), 0);
                const totalRow = document.createElement('tr');
                totalRow.style.cssText = 'background:linear-gradient(135deg,rgba(14,116,144,0.1),rgba(6,182,212,0.08));border-top:2px solid rgba(14,116,144,0.25);';
                totalRow.innerHTML = `
                    <td colspan="5" style="padding:14px 12px;font-weight:700;color:#0c4a6e;font-size:14px;">
                        üí∞ Total Halaman Ini (${pageData.length} transaksi)
                    </td>
                    <td style="padding:14px 12px;">
                        <strong style="color:#0e7490;font-size:15px;">${formatRupiah(grandTotal)}</strong>
                    </td>
                    <td colspan="3"></td>
                `;
                tbody.appendChild(totalRow);
            }

            // Pagination info
            document.getElementById('paginationInfo').textContent =
                total === 0 ? 'Tidak ada item' : `Menampilkan ${start + 1}‚Äì${end} dari ${total} item`;

            renderPagination(totalPages);
            updateSelectAllState();

            // Button events - bind after render
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => viewItem(parseInt(btn.dataset.index)));
            });
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', () => openEditModal(parseInt(btn.dataset.index)));
            });
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', () => deleteItem(parseInt(btn.dataset.index)));
            });
            document.querySelectorAll('.row-checkbox').forEach(cb => {
                cb.addEventListener('change', updateSelectAllState);
            });
        }

        function renderPagination(totalPages) {
            const container = document.getElementById('paginationControls');
            container.innerHTML = '';

            const prevBtn = document.createElement('button');
            prevBtn.className = 'pagination-btn';
            prevBtn.textContent = '‚Üê Sebelumnya';
            prevBtn.disabled = currentPage === 1;
            prevBtn.addEventListener('click', () => { if (currentPage > 1) { currentPage--; renderTable(); } });
            container.appendChild(prevBtn);

            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.className = 'pagination-btn' + (i === currentPage ? ' active' : '');
                btn.textContent = i;
                btn.addEventListener('click', () => { currentPage = i; renderTable(); });
                container.appendChild(btn);
            }

            const nextBtn = document.createElement('button');
            nextBtn.className = 'pagination-btn';
            nextBtn.textContent = 'Selanjutnya ‚Üí';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.addEventListener('click', () => { if (currentPage < totalPages) { currentPage++; renderTable(); } });
            container.appendChild(nextBtn);
        }

        function updateSelectAllState() {
            const checkboxes = document.querySelectorAll('.row-checkbox');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const selectAll = document.getElementById('selectAll');
            selectAll.checked = checkedCount === checkboxes.length && checkboxes.length > 0;
            selectAll.indeterminate = checkedCount > 0 && checkedCount < checkboxes.length;
        }

        // ===== VIEW DETAIL =====
        function viewItem(index) {
            const item = outgoingData[index];
            if (!item) return;

            const itemsList = item.items.map(p =>
                `<tr>
                    <td style="padding:8px 10px;">${p.name}</td>
                    <td style="padding:8px 10px;text-align:center;">${p.quantity} ${p.unit}</td>
                    <td style="padding:8px 10px;text-align:right;">${formatRupiah(p.price)}</td>
                    <td style="padding:8px 10px;text-align:right;font-weight:600;color:#059669;">${formatRupiah(p.price * p.quantity)}</td>
                </tr>`
            ).join('');
            const grandTotal = calcItemTotal(item.items);
            const statusText = { completed: 'Selesai', pending: 'Pending', cancelled: 'Dibatalkan' }[item.status] || item.status;

            const html = `
                <div class="modal-overlay active" id="detailModal">
                    <div class="modal-content" style="max-width:680px;">
                        <div class="modal-header">
                            <h3>üìã Detail Barang Keluar</h3>
                            <button class="close-modal" onclick="closeDetailModal()">‚úï</button>
                        </div>
                        <div style="display:grid;gap:12px;margin-top:5px;">
                            ${detailRow('ID Transaksi', item.id)}
                            ${detailRow('Tanggal', item.date.replace('T', ' '), true)}
                            ${detailRow('Tujuan', formatDestination(item.destination))}
                            ${detailRow('Keterangan Tujuan', item.destinationNote || '-', true)}
                            ${detailRow('Alamat', item.address)}
                            ${detailRow('Status', statusText, true)}
                            ${detailRow('Petugas', item.officer)}
                            <div style="padding:15px;background:rgba(6,182,212,0.08);border-radius:8px;border-left:4px solid #06b6d4;">
                                <strong style="color:#0c4a6e;display:block;margin-bottom:12px;">Daftar Barang:</strong>
                                <table style="width:100%;border-collapse:collapse;font-size:13px;">
                                    <thead>
                                        <tr style="background:rgba(14,116,144,0.12);">
                                            <th style="padding:8px 10px;text-align:left;color:#0c4a6e;">Barang</th>
                                            <th style="padding:8px 10px;text-align:center;color:#0c4a6e;">Qty</th>
                                            <th style="padding:8px 10px;text-align:right;color:#0c4a6e;">Harga Satuan</th>
                                            <th style="padding:8px 10px;text-align:right;color:#0c4a6e;">Subtotal</th>
                                        </tr>
                                    </thead>
                                    <tbody style="color:#475569;">${itemsList}</tbody>
                                    <tfoot>
                                        <tr style="border-top:2px solid rgba(14,116,144,0.2);background:rgba(5,150,105,0.08);">
                                            <td colspan="3" style="padding:10px;font-weight:700;color:#0c4a6e;">Grand Total</td>
                                            <td style="padding:10px;text-align:right;font-weight:800;font-size:15px;color:#059669;">${formatRupiah(grandTotal)}</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            ${item.notes ? `<div style="padding:12px;background:rgba(245,158,11,0.1);border-radius:8px;">
                                <strong style="color:#0c4a6e;display:block;margin-bottom:6px;">Catatan:</strong>
                                <span style="color:#475569;">${item.notes}</span>
                            </div>` : ''}
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeDetailModal()">Tutup</button>
                            <button class="btn btn-primary" onclick="closeDetailModal();openEditModal(${index})">‚úèÔ∏è Edit</button>
                        </div>
                    </div>
                </div>`;

            // Remove existing detail modal if any
            const existing = document.getElementById('detailModal');
            if (existing) existing.remove();
            document.body.insertAdjacentHTML('beforeend', html);
        }

        function detailRow(label, value, alt = false) {
            const bg = alt ? 'background:rgba(14,116,144,0.05);border-radius:8px;' : '';
            return `<div style="display:grid;grid-template-columns:150px 1fr;gap:10px;padding:10px;${bg}">
                <strong style="color:#0c4a6e;">${label}:</strong>
                <span style="color:#475569;">${value}</span>
            </div>`;
        }

        function closeDetailModal() {
            const m = document.getElementById('detailModal');
            if (m) { m.classList.remove('active'); setTimeout(() => m.remove(), 300); }
        }

        // ===== MODAL OPEN/CLOSE =====
        function openAddModal() {
            document.getElementById('modalTitle').textContent = 'Tambah Barang Keluar';
            document.getElementById('outgoingForm').reset();
            document.getElementById('editIndex').value = '-1';
            document.getElementById('transactionId').value = generateId();
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('outgoingDate').value = now.toISOString().slice(0, 16);
            document.getElementById('productItems').innerHTML = '';
            addProductItem();
            document.getElementById('outgoingModal').classList.add('active');
        }

        function openEditModal(index) {
            const item = outgoingData[index];
            if (!item) return;

            document.getElementById('modalTitle').textContent = 'Edit Barang Keluar';
            document.getElementById('editIndex').value = index;
            document.getElementById('transactionId').value = item.id;
            document.getElementById('outgoingDate').value = item.date;
            document.getElementById('destination').value = item.destination;
            document.getElementById('destinationNote').value = item.destinationNote || '';
            document.getElementById('addressInput').value = item.address || '';
            document.getElementById('officer').value = item.officer;
            document.getElementById('status').value = item.status;
            document.getElementById('notes').value = item.notes || '';

            const productItems = document.getElementById('productItems');
            productItems.innerHTML = '';
            item.items.forEach(p => addProductItem(p));

            document.getElementById('outgoingModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('outgoingModal').classList.remove('active');
        }

        // ===== PRODUCT ITEMS =====
        function addProductItem(product = null) {
            const container = document.getElementById('productItems');
            const div = document.createElement('div');
            div.className = 'product-item';

            let opts = '<option value="">Pilih Barang</option>';
            availableProducts.forEach(p => {
                const sel = product && product.productId === p.id ? 'selected' : '';
                opts += `<option value="${p.id}" data-unit="${p.unit}" data-price="${p.price}" ${sel}>${p.name} (Stok: ${p.stock} ${p.unit})</option>`;
            });

            const initQty = product ? product.quantity : '';
            const initPrice = product ? product.price : '';
            const initUnit = product ? product.unit : '';
            const initSubtotal = (initQty && initPrice) ? formatRupiah(initQty * initPrice) : 'Rp 0';

            div.innerHTML = `
                <select class="form-select product-select" required>${opts}</select>
                <input type="number" class="form-input qty-input" placeholder="Jumlah" min="1" value="${initQty}" required>
                <input type="text" class="form-input unit-input" placeholder="Satuan" value="${initUnit}" readonly>
                <input type="number" class="form-input price-input" placeholder="Harga Satuan" min="0" value="${initPrice}" required>
                <div class="subtotal-display" style="background:rgba(5,150,105,0.1);border-radius:8px;padding:10px 12px;font-size:13px;font-weight:700;color:#059669;text-align:right;white-space:nowrap;">${initSubtotal}</div>
                <button type="button" class="action-btn remove-item-btn" title="Hapus baris">üóëÔ∏è</button>
            `;

            function updateSubtotal() {
                const qty = parseFloat(div.querySelector('.qty-input').value) || 0;
                const price = parseFloat(div.querySelector('.price-input').value) || 0;
                div.querySelector('.subtotal-display').textContent = formatRupiah(qty * price);
            }

            div.querySelector('.product-select').addEventListener('change', function () {
                const opt = this.options[this.selectedIndex];
                div.querySelector('.unit-input').value = opt.dataset.unit || '';
                div.querySelector('.price-input').value = opt.dataset.price || '';
                updateSubtotal();
            });

            div.querySelector('.qty-input').addEventListener('input', updateSubtotal);
            div.querySelector('.price-input').addEventListener('input', updateSubtotal);
            div.querySelector('.remove-item-btn').addEventListener('click', () => div.remove());

            container.appendChild(div);
        }

        // ===== SAVE FORM =====
        document.getElementById('outgoingForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const rows = document.querySelectorAll('.product-item');
            const items = [];
            let valid = true;

            rows.forEach(row => {
                const select = row.querySelector('.product-select');
                const qty = row.querySelector('.qty-input');
                const unit = row.querySelector('.unit-input');
                const priceInput = row.querySelector('.price-input');

                if (!select.value || !qty.value || !priceInput.value) { valid = false; return; }

                const prod = availableProducts.find(p => p.id == select.value);
                items.push({
                    productId: parseInt(select.value),
                    name: prod ? prod.name : '',
                    quantity: parseInt(qty.value),
                    unit: unit.value,
                    price: parseFloat(priceInput.value)
                });
            });

            if (!valid || items.length === 0) {
                showNotification('Lengkapi semua field barang yang dikeluarkan!', 'error');
                return;
            }

            const editIndex = parseInt(document.getElementById('editIndex').value);
            const newItem = {
                id: document.getElementById('transactionId').value,
                date: document.getElementById('outgoingDate').value,
                items,
                destination: document.getElementById('destination').value,
                destinationNote: document.getElementById('destinationNote').value,
                address: document.getElementById('addressInput').value,
                officer: document.getElementById('officer').value,
                status: document.getElementById('status').value,
                notes: document.getElementById('notes').value
            };

            if (editIndex >= 0) {
                outgoingData[editIndex] = newItem;
                showNotification(`Data ${newItem.id} berhasil diperbarui!`, 'success');
            } else {
                outgoingData.unshift(newItem);
                showNotification(`Data ${newItem.id} berhasil ditambahkan!`, 'success');
            }

            closeModal();
            applyFilters();
        });

        // ===== DELETE =====
        function deleteItem(index) {
            const item = outgoingData[index];
            if (!item) return;

            const html = `
                <div class="modal-overlay active" id="confirmDeleteModal">
                    <div class="modal-content" style="max-width:420px;">
                        <div class="modal-header" style="border-bottom:2px solid rgba(244,63,94,0.2);">
                            <h3 style="color:#e11d48;">‚ö†Ô∏è Konfirmasi Hapus</h3>
                            <button class="close-modal" onclick="closeConfirmModal()">‚úï</button>
                        </div>
                        <div style="padding:20px 0;">
                            <p style="color:#475569;margin-bottom:15px;">Apakah Anda yakin ingin menghapus data berikut?</p>
                            <div style="background:rgba(244,63,94,0.08);padding:15px;border-radius:10px;border-left:4px solid #e11d48;">
                                <div style="margin-bottom:8px;"><strong style="color:#0c4a6e;">ID:</strong> <span>${item.id}</span></div>
                                <div style="margin-bottom:8px;"><strong style="color:#0c4a6e;">Tanggal:</strong> <span>${item.date.replace('T', ' ')}</span></div>
                                <div><strong style="color:#0c4a6e;">Petugas:</strong> <span>${item.officer}</span></div>
                            </div>
                            <p style="color:#e11d48;font-size:13px;margin-top:14px;font-weight:600;">‚ö†Ô∏è Data yang dihapus tidak dapat dikembalikan!</p>
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn-secondary" onclick="closeConfirmModal()">Batal</button>
                            <button class="btn btn-danger" onclick="confirmDelete(${index})">üóëÔ∏è Hapus</button>
                        </div>
                    </div>
                </div>`;

            const existing = document.getElementById('confirmDeleteModal');
            if (existing) existing.remove();
            document.body.insertAdjacentHTML('beforeend', html);
        }

        function closeConfirmModal() {
            const m = document.getElementById('confirmDeleteModal');
            if (m) { m.classList.remove('active'); setTimeout(() => m.remove(), 300); }
        }

        function confirmDelete(index) {
            const id = outgoingData[index]?.id;
            outgoingData.splice(index, 1);
            closeConfirmModal();
            applyFilters();
            showNotification(`Data ${id} berhasil dihapus!`, 'success');
        }

        // ===== NOTIFICATIONS =====
        function showNotification(message, type = 'success') {
            const colors = {
                success: { bg: 'linear-gradient(135deg, #10b981, #059669)', shadow: 'rgba(16,185,129,0.4)', icon: '‚úì' },
                error: { bg: 'linear-gradient(135deg, #f43f5e, #e11d48)', shadow: 'rgba(244,63,94,0.4)', icon: '‚úï' }
            };
            const c = colors[type] || colors.success;
            const el = document.createElement('div');
            el.style.cssText = `position:fixed;top:20px;right:20px;background:${c.bg};color:white;padding:15px 25px;
                border-radius:12px;box-shadow:0 4px 20px ${c.shadow};z-index:10000;
                animation:slideInRight 0.3s ease-out;display:flex;align-items:center;gap:10px;font-weight:600;`;
            el.innerHTML = `<span style="font-size:20px;">${c.icon}</span><span>${message}</span>`;
            document.body.appendChild(el);
            setTimeout(() => {
                el.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => el.remove(), 300);
            }, 3000);
        }

        // ===== PRINT =====
        function printReport() {
            const rows = filteredData.map(item => `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.date.replace('T', ' ')}</td>
                    <td>${item.address}</td>
                    <td>${formatDestination(item.destination)}</td>
                    <td>${item.items.map(i => `${i.name} (${i.quantity} ${i.unit} √ó ${formatRupiah(i.price)})`).join('<br>')}</td>
                    <td style="text-align:right;font-weight:700;color:#059669;">${formatRupiah(calcItemTotal(item.items))}</td>
                    <td>${item.status === 'completed' ? 'Selesai' : item.status === 'pending' ? 'Pending' : 'Dibatalkan'}</td>
                    <td>${item.officer}</td>
                </tr>`).join('');

            const grandTotal = filteredData.reduce((sum, item) => sum + calcItemTotal(item.items), 0);

            const win = window.open('', '_blank');
            win.document.write(`
                <html><head><title>Laporan Barang Keluar - Mekar Jaya</title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 20px; font-size: 13px; }
                    h2 { color: #0c4a6e; margin-bottom: 5px; }
                    p { color: #64748b; margin-bottom: 20px; }
                    table { width: 100%; border-collapse: collapse; }
                    th { background: #0e7490; color: white; padding: 10px 8px; text-align: left; }
                    td { padding: 8px; border-bottom: 1px solid #e2e8f0; vertical-align: top; }
                    tr:nth-child(even) td { background: #f8fafc; }
                    .grand-total td { background: #f0fdf4; font-weight: 700; border-top: 2px solid #059669; }
                </style></head>
                <body>
                    <h2>üé£ Mekar Jaya - Laporan Barang Keluar</h2>
                    <p>Dicetak pada: ${new Date().toLocaleString('id-ID')} | Total transaksi: ${filteredData.length}</p>
                    <table>
                        <thead><tr>
                            <th>ID</th><th>Tanggal</th><th>Alamat</th>
                            <th>Tujuan</th><th>Barang</th><th>Total</th><th>Status</th><th>Petugas</th>
                        </tr></thead>
                        <tbody>${rows}</tbody>
                        <tfoot>
                            <tr class="grand-total">
                                <td colspan="5" style="text-align:right;padding:10px;">Grand Total Keseluruhan:</td>
                                <td style="color:#059669;font-size:14px;">${formatRupiah(grandTotal)}</td>
                                <td colspan="2"></td>
                            </tr>
                        </tfoot>
                    </table>
                </body></html>`);
            win.document.close();
            win.print();
        }

        function deleteBulk(ids) {
            outgoingData = outgoingData.filter(d => !ids.includes(d.id));
            closeConfirmModal();
            applyFilters();
            showNotification(`${ids.length} item berhasil dihapus!`, 'success');
        }

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', function () {
            // Initial render
            applyFilters();

            // Loading navigation
            document.querySelectorAll('.menu-item[data-loading="true"]').forEach(item => {
                item.addEventListener('click', function (e) {
                    e.preventDefault();
                    const url = this.href;
                    document.getElementById('loadingOverlay').classList.add('active');
                    setTimeout(() => { window.location.href = url; }, 1200);
                });
            });

            // Sidebar toggle
            document.getElementById('menuToggle').addEventListener('click', () => {
                document.getElementById('sidebar').classList.toggle('active');
                document.getElementById('overlay').classList.toggle('active');
            });
            document.getElementById('overlay').addEventListener('click', () => {
                document.getElementById('sidebar').classList.remove('active');
                document.getElementById('overlay').classList.remove('active');
            });

            // Add button
            document.getElementById('addOutgoingBtn').addEventListener('click', openAddModal);

            // Modal close
            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('cancelBtn').addEventListener('click', closeModal);

            // Add product item
            document.getElementById('addProductBtn').addEventListener('click', () => addProductItem());

            // Select all checkbox
            document.getElementById('selectAll').addEventListener('change', function () {
                document.querySelectorAll('.row-checkbox').forEach(cb => cb.checked = this.checked);
            });

            // Rows per page
            document.getElementById('rowsPerPage').addEventListener('change', function () {
                rowsPerPage = parseInt(this.value);
                currentPage = 1;
                renderTable();
            });

            // Filter buttons
            document.getElementById('applyFilter').addEventListener('click', () => {
                applyFilters();
                showNotification('Filter berhasil diterapkan!', 'success');
            });
            document.getElementById('resetFilter').addEventListener('click', () => {
                document.getElementById('startDate').value = '';
                document.getElementById('endDate').value = '';
                document.getElementById('statusFilter').value = 'all';
                document.getElementById('destinationFilter').value = 'all';
                document.getElementById('searchInput').value = '';
                applyFilters();
                showNotification('Filter direset!', 'success');
            });

            // Live search
            document.getElementById('searchInput').addEventListener('input', applyFilters);

            // Refresh
            document.getElementById('refreshBtn').addEventListener('click', () => {
                applyFilters();
                showNotification('Data diperbarui!', 'success');
            });

            // Print
            document.getElementById('printBtn').addEventListener('click', printReport);

            // Delete selected
            document.getElementById('deleteSelectedBtn').addEventListener('click', () => {
                const selected = Array.from(document.querySelectorAll('.row-checkbox:checked')).map(cb => cb.dataset.id);
                if (selected.length === 0) {
                    showNotification('Pilih setidaknya satu item untuk dihapus!', 'error');
                    return;
                }
                const html = `
                    <div class="modal-overlay active" id="confirmDeleteModal">
                        <div class="modal-content" style="max-width:400px;">
                            <div class="modal-header" style="border-bottom:2px solid rgba(244,63,94,0.2);">
                                <h3 style="color:#e11d48;">‚ö†Ô∏è Konfirmasi Hapus</h3>
                                <button class="close-modal" onclick="closeConfirmModal()">‚úï</button>
                            </div>
                            <div style="padding:20px 0;">
                                <p style="color:#475569;">Hapus <strong>${selected.length} item</strong> terpilih? Tindakan ini tidak dapat dibatalkan.</p>
                            </div>
                            <div class="modal-actions">
                                <button class="btn btn-secondary" onclick="closeConfirmModal()">Batal</button>
                                <button class="btn btn-danger" onclick="deleteBulk(${JSON.stringify(selected)})">üóëÔ∏è Hapus Semua</button>
                            </div>
                        </div>
                    </div>`;
                const existing = document.getElementById('confirmDeleteModal');
                if (existing) existing.remove();
                document.body.insertAdjacentHTML('beforeend', html);
            });
        });
    </script>

    <div class="logout-modal" id="logoutModal">
        <div class="logout-box">
            <div class="logout-icon">üö™</div>
            <h3>Yakin ingin logout?</h3>
            <p>Anda akan keluar dari sistem Kasir Mekar Jaya</p>
            <div class="logout-actions">
                <button class="btn-cancel" id="cancelLogout">Batal</button>
                <button class="btn-confirm" id="confirmLogout">Ya, Logout</button>
            </div>
        </div>
    </div>

    <script>
        const logoutBtn = document.querySelector('.logout-btn');
        const logoutModal = document.getElementById('logoutModal');
        const cancelLogout = document.getElementById('cancelLogout');
        const confirmLogout = document.getElementById('confirmLogout');

        logoutBtn.addEventListener('click', function (e) {
            e.preventDefault();
            logoutModal.classList.add('active');
        });

        cancelLogout.addEventListener('click', function () {
            logoutModal.classList.remove('active');
        });

        confirmLogout.addEventListener('click', function () {
            // Hapus session login
            localStorage.removeItem('userLogin');
            localStorage.removeItem('userRole');

            // Redirect (PATH TERBARU)
            window.location.href = '../../pages/login.html';
        });
    </script>

    <div class="logout-modal" id="logoutModal">
        <div class="logout-box">
            <div class="logout-icon">üö™</div>
            <h3>Yakin ingin logout?</h3>
            <p>Anda akan keluar dari sistem Kasir Mekar Jaya</p>
            <div class="logout-actions">
                <button class="btn-cancel" id="cancelLogout">Batal</button>
                <button class="btn-confirm" id="confirmLogout">Ya, Logout</button>
            </div>
        </div>
    </div>


</body>

</html>