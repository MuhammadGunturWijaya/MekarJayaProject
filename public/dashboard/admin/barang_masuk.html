<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - Mekar Jaya</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow-x: hidden; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0c4a6e 0%, #0e7490 50%, #06b6d4 100%);
            background-attachment: fixed;
        }

        /* Sidebar */
        .sidebar {
            position: fixed; left: 0; top: 0; width: 280px; height: 100vh;
            background: linear-gradient(180deg, #164e63 0%, #0e7490 100%);
            padding: 25px 20px; z-index: 1000; transition: transform 0.3s ease;
            overflow-y: auto; box-shadow: 4px 0 20px rgba(0,0,0,0.2);
        }
        .sidebar.hidden { transform: translateX(-100%); }
        .logo-section {
            display: flex; align-items: center; gap: 15px; padding: 20px 15px;
            margin-bottom: 35px; background: rgba(255,255,255,0.1); border-radius: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
        }
        .logo-section .icon { font-size: 36px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .logo-section h2 { color: white; font-size: 22px; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .logo-section .badge { background: linear-gradient(135deg,#22d3ee,#06b6d4); color: white; font-size: 10px; padding: 4px 10px; border-radius: 8px; font-weight: 700; }
        .menu-section { margin-bottom: 30px; }
        .menu-label { color: rgba(255,255,255,0.5); font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; padding: 0 15px; margin-bottom: 12px; }
        .menu-item {
            display: flex; align-items: center; gap: 15px; padding: 14px 18px;
            color: rgba(255,255,255,0.8); text-decoration: none; border-radius: 15px;
            margin-bottom: 6px; transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
            cursor: pointer; font-size: 15px; position: relative;
        }
        .menu-item:hover { background: rgba(255,255,255,0.15); color: white; transform: translateX(5px); }
        .menu-item.active {
            background: linear-gradient(135deg,rgba(34,211,238,0.3),rgba(6,182,212,0.2));
            color: white; font-weight: 600; box-shadow: 0 4px 15px rgba(34,211,238,0.3);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .menu-item .icon { font-size: 22px; width: 28px; text-align: center; }
        .menu-item .badge { margin-left: auto; background: linear-gradient(135deg,#f43f5e,#e11d48); color: white; font-size: 11px; padding: 3px 8px; border-radius: 12px; font-weight: 700; }

        /* Main Content */
        .main-content { margin-left: 280px; padding: 25px; min-height: 100vh; transition: margin-left 0.3s ease; }
        .main-content.expanded { margin-left: 0; }

        /* Header */
        .header {
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 25px 30px;
            border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 25px;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(255,255,255,0.5);
        }
        .header-left h1 { background: linear-gradient(135deg,#0c4a6e,#06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 28px; margin-bottom: 6px; font-weight: 800; }
        .header-left p { color: #64748b; font-size: 15px; }
        .header-right { display: flex; gap: 12px; align-items: center; }
        .search-box { position: relative; display: flex; }
        .search-box input { padding: 12px 18px 12px 45px; border: 2px solid rgba(14,116,144,0.2); border-radius: 15px; width: 240px; font-size: 14px; transition: all 0.3s; background: rgba(255,255,255,0.9); }
        .search-box input:focus { outline: none; border-color: #0e7490; box-shadow: 0 0 0 4px rgba(14,116,144,0.1); }
        .search-box .icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); font-size: 18px; }
        .notification-btn { position: relative; background: linear-gradient(135deg,#0e7490,#06b6d4); border: none; padding: 12px; border-radius: 15px; cursor: pointer; font-size: 20px; transition: all 0.3s; box-shadow: 0 4px 15px rgba(14,116,144,0.3); }
        .notification-badge { position: absolute; top: 5px; right: 5px; background: linear-gradient(135deg,#f43f5e,#e11d48); color: white; font-size: 10px; padding: 3px 6px; border-radius: 10px; font-weight: 700; }
        .menu-toggle { display: none; background: linear-gradient(135deg,#0e7490,#06b6d4); border: none; color: white; padding: 12px 18px; border-radius: 15px; cursor: pointer; font-size: 20px; }

        /* Card */
        .card { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 25px; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.5); margin-bottom: 25px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .card-header h3 { color: #0c4a6e; font-size: 18px; font-weight: 800; }

        /* Form Container */
        .form-container { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 25px; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 25px; border: 1px solid rgba(255,255,255,0.5); }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .form-group { margin-bottom: 18px; position: relative; }
        .form-group label { display: block; color: #0c4a6e; font-size: 14px; font-weight: 600; margin-bottom: 8px; }
        .form-group input, .form-group select {
            width: 100%; padding: 12px 15px; border: 2px solid rgba(14,116,144,0.2);
            border-radius: 12px; font-size: 14px; transition: all 0.3s; background: rgba(255,255,255,0.9);
        }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #0e7490; box-shadow: 0 0 0 4px rgba(14,116,144,0.1); }
        .form-actions { display: flex; gap: 12px; justify-content: flex-end; margin-top: 25px; }

        /* Autocomplete */
        .autocomplete-wrapper { position: relative; }
        .autocomplete-dropdown {
            position: absolute; top: 100%; left: 0; right: 0; background: white;
            border: 2px solid #0e7490; border-radius: 12px; z-index: 100;
            max-height: 220px; overflow-y: auto; box-shadow: 0 8px 25px rgba(14,116,144,0.2);
            display: none;
        }
        .autocomplete-dropdown.open { display: block; }
        .autocomplete-item {
            padding: 11px 15px; cursor: pointer; font-size: 14px; color: #0c4a6e;
            border-bottom: 1px solid rgba(14,116,144,0.1); transition: background 0.2s;
            display: flex; align-items: center; gap: 10px;
        }
        .autocomplete-item:last-child { border-bottom: none; }
        .autocomplete-item:hover { background: rgba(14,116,144,0.08); }
        .autocomplete-item.new-item { color: #059669; font-weight: 600; }
        .autocomplete-item .item-cat { font-size: 11px; color: #94a3b8; margin-left: auto; background: rgba(14,116,144,0.1); padding: 2px 8px; border-radius: 8px; }
        .autocomplete-hint { font-size: 12px; color: #94a3b8; margin-top: 5px; }

        /* Buttons */
        .btn { padding: 12px 25px; border: none; border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px; }
        .btn-primary { background: linear-gradient(135deg,#0e7490,#06b6d4); color: white; box-shadow: 0 4px 15px rgba(14,116,144,0.3); }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(14,116,144,0.4); }
        .btn-secondary { background: rgba(255,255,255,0.9); border: 2px solid rgba(14,116,144,0.2); color: #0c4a6e; }
        .btn-secondary:hover { border-color: #0e7490; transform: translateY(-3px); }
        .filter-btn { background: linear-gradient(135deg,#0e7490,#06b6d4); border: none; padding: 10px 18px; border-radius: 12px; font-size: 13px; color: white; cursor: pointer; transition: all 0.3s; font-weight: 600; }
        .print-btn { background: linear-gradient(135deg,#10b981,#059669); border: none; padding: 10px 18px; border-radius: 12px; font-size: 13px; color: white; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px; }
        .print-btn:hover, .filter-btn:hover { transform: scale(1.05); }

        /* Filter Bar */
        .filter-bar { background: rgba(14,116,144,0.05); border-radius: 15px; padding: 18px; margin-bottom: 20px; border: 1px solid rgba(14,116,144,0.15); display: none; }
        .filter-bar.open { display: block; }
        .filter-bar-title { font-size: 14px; font-weight: 700; color: #0c4a6e; margin-bottom: 15px; }
        .filter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end; }
        .filter-group label { font-size: 12px; color: #64748b; font-weight: 600; display: block; margin-bottom: 6px; }
        .filter-group input, .filter-group select { padding: 9px 12px; border: 1.5px solid rgba(14,116,144,0.2); border-radius: 10px; font-size: 13px; width: 100%; transition: all 0.2s; }
        .filter-group input:focus, .filter-group select:focus { outline: none; border-color: #0e7490; }
        .filter-actions { display: flex; gap: 10px; padding-top: 15px; border-top: 1px solid rgba(14,116,144,0.1); margin-top: 15px; }
        .btn-filter-apply { background: linear-gradient(135deg,#0e7490,#06b6d4); color: white; padding: 9px 18px; border: none; border-radius: 10px; font-size: 13px; font-weight: 600; cursor: pointer; }
        .btn-filter-reset { background: white; color: #64748b; padding: 9px 18px; border: 1.5px solid rgba(14,116,144,0.2); border-radius: 10px; font-size: 13px; font-weight: 600; cursor: pointer; }

        /* Search Container */
        .search-container { position: relative; margin-bottom: 20px; }
        .search-container input { width: 100%; padding: 12px 18px 12px 45px; border: 2px solid rgba(14,116,144,0.2); border-radius: 15px; font-size: 14px; transition: all 0.3s; }
        .search-container input:focus { outline: none; border-color: #0e7490; box-shadow: 0 0 0 4px rgba(14,116,144,0.1); }
        .search-container .icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); font-size: 18px; color: #64748b; }

        /* Table */
        .table-container { overflow-x: auto; border-radius: 12px; margin-top: 5px; max-height: 480px; overflow-y: auto; scrollbar-width: thin; scrollbar-color: #0e7490 rgba(255,255,255,0.1); }
        .table-container::-webkit-scrollbar { height: 7px; width: 7px; }
        .table-container::-webkit-scrollbar-thumb { background: linear-gradient(135deg,#0e7490,#06b6d4); border-radius: 4px; }
        .item-list { min-width: 900px; border: 1px solid rgba(14,116,144,0.2); border-radius: 12px; overflow: hidden; }
        .item-header { display: grid; grid-template-columns: 1.5fr 1fr 0.8fr 1fr 1fr 1.3fr 1fr 0.8fr 0.8fr; background: linear-gradient(135deg,rgba(14,116,144,0.12),rgba(6,182,212,0.1)); padding: 12px 15px; font-weight: 700; color: #0c4a6e; font-size: 12px; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid rgba(14,116,144,0.15); }
        .item-row { display: grid; grid-template-columns: 1.5fr 1fr 0.8fr 1fr 1fr 1.3fr 1fr 0.8fr 0.8fr; padding: 13px 15px; border-bottom: 1px solid rgba(14,116,144,0.08); align-items: center; transition: all 0.2s; font-size: 13px; }
        .item-row:hover { background: rgba(14,116,144,0.05); }
        .item-row:last-child { border-bottom: none; }
        .item-actions { display: flex; gap: 6px; }
        .btn-icon { background: none; border: none; font-size: 16px; cursor: pointer; padding: 6px; border-radius: 8px; transition: all 0.2s; }
        .btn-edit { color: #0e7490; }
        .btn-edit:hover { background: rgba(14,116,144,0.1); transform: scale(1.15); }
        .btn-delete { color: #f43f5e; }
        .btn-delete:hover { background: rgba(244,63,94,0.1); transform: scale(1.15); }

        /* Status Badge */
        .status-badge { padding: 5px 11px; border-radius: 20px; font-size: 11px; font-weight: 700; display: inline-block; text-align: center; }
        .status-badge.aman { background: rgba(16,185,129,0.15); color: #059669; }
        .status-badge.menipis { background: rgba(245,158,11,0.15); color: #d97706; }
        .status-badge.habis { background: rgba(244,63,94,0.15); color: #e11d48; }

        /* Empty state */
        .empty-state { text-align: center; padding: 50px 20px; color: #94a3b8; }
        .empty-state .icon { font-size: 50px; margin-bottom: 15px; opacity: 0.4; display: block; }

        /* Pagination */
        .pagination { display: flex; justify-content: center; gap: 8px; margin-top: 20px; }
        .pagination-btn { padding: 8px 13px; border: 1px solid rgba(14,116,144,0.2); background: white; border-radius: 8px; cursor: pointer; font-size: 13px; transition: all 0.2s; }
        .pagination-btn.active { background: linear-gradient(135deg,#0e7490,#06b6d4); color: white; border-color: transparent; }
        .pagination-btn:hover:not(.active) { background: rgba(14,116,144,0.1); }

        /* Total Summary */
        .total-summary { display: flex; justify-content: space-between; margin-top: 18px; padding: 14px 18px; background: rgba(14,116,144,0.07); border-radius: 12px; font-weight: 600; color: #0c4a6e; font-size: 14px; }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(12,74,110,0.7); backdrop-filter: blur(5px); z-index: 2000; justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 20px; width: 90%; max-width: 640px; box-shadow: 0 10px 40px rgba(0,0,0,0.25); overflow: hidden; max-height: 90vh; overflow-y: auto; }
        .modal-header { padding: 20px 25px; background: linear-gradient(135deg,#0e7490,#06b6d4); color: white; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; }
        .modal-header h3 { margin: 0; font-size: 18px; }
        .modal-close { background: none; border: none; color: white; font-size: 22px; cursor: pointer; opacity: 0.85; transition: opacity 0.2s; }
        .modal-close:hover { opacity: 1; }
        .modal-body { padding: 25px; }
        .modal-footer { padding: 15px 25px; background: rgba(14,116,144,0.05); display: flex; justify-content: flex-end; gap: 12px; }

        /* Loading */
        .loading-overlay { position: fixed; inset: 0; display: none; justify-content: center; align-items: center; background: rgba(255,255,255,0.2); backdrop-filter: blur(8px); z-index: 9999; }
        .loading-overlay.active { display: flex; }
        .dots-loader { background: linear-gradient(120deg,rgba(90,167,255,0.35),rgba(255,255,255,0.05)); backdrop-filter: blur(20px); padding: 35px 55px; border-radius: 24px; border: 1px solid rgba(255,255,255,0.3); box-shadow: 0 8px 30px rgba(90,167,255,0.35); text-align: center; }
        .dots { display: flex; gap: 10px; justify-content: center; margin-bottom: 15px; }
        .dots span { width: 12px; height: 12px; background: #7b5dfc; border-radius: 50%; animation: pulseDots 1.2s infinite ease-in-out; }
        .dots span:nth-child(1) { animation-delay: 0s; }
        .dots span:nth-child(2) { animation-delay: 0.2s; }
        .dots span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes pulseDots { 0%,100%{transform:scale(0.6);opacity:0.5} 40%{transform:scale(1.2);opacity:1} }
        .loading-title { font-size: 14px; color: #444; letter-spacing: 1px; margin: 0; }

        /* Overlay */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(12,74,110,0.7); backdrop-filter: blur(5px); z-index: 999; }
        .overlay.active { display: block; }

        /* Alert toast */
        .toast { position: fixed; top: 25px; right: 25px; z-index: 9999; padding: 15px 22px; border-radius: 14px; font-size: 14px; font-weight: 600; color: white; box-shadow: 0 6px 25px rgba(0,0,0,0.2); transform: translateX(120%); transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1); display: flex; align-items: center; gap: 10px; }
        .toast.show { transform: translateX(0); }
        .toast.success { background: linear-gradient(135deg,#10b981,#059669); }
        .toast.error { background: linear-gradient(135deg,#f43f5e,#e11d48); }
        .toast.warning { background: linear-gradient(135deg,#f59e0b,#d97706); }

        /* Result count */
        .result-count { font-size: 12px; color: #64748b; margin-bottom: 10px; padding: 6px 12px; background: rgba(14,116,144,0.07); border-radius: 8px; display: inline-block; }

        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.active { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 18px; }
            .menu-toggle { display: block; }
            .header { flex-direction: column; gap: 18px; padding: 20px; }
            .header-right { width: 100%; justify-content: space-between; }
            .search-box { flex: 1; }
            .search-box input { width: 100%; }
            .form-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="overlay" id="overlay"></div>

<aside class="sidebar" id="sidebar">
        <div class="logo-section">
            <span class="icon">üé£</span>
            <div>
                <h2>Mekar Jaya</h2>
                <span class="badge">ADMIN</span>
            </div>
        </div>
        <a href="../admin/kasir.html" class="menu-item" data-loading="true">
            <span class="icon">üñ•Ô∏è</span><span>Kasir</span>
        </a>
        <div class="menu-section">
            <div class="menu-label">Menu Utama</div>
            <a href="../admin/dashboard.html" class="menu-item" data-loading="true">
                <span class="icon">üìä</span><span>Dashboard</span>
            </a>
            <a href="../admin/master_data.html" class="menu-item" data-loading="true">
                <span class="icon">üßæ</span><span>Master Data</span>
            </a>
            <a href="../admin/barang_masuk.html" class="menu-item active" data-loading="true">
                <span class="icon">üöö</span><span>Barang Masuk</span>
            </a>
            <a href="../admin/barang_keluar.html" class="menu-item " data-loading="true">
                <span class="icon">üì¶</span><span>Barang Keluar</span>
     
            </a>
            <a href="../admin/generate_laporan.html" class="menu-item" data-loading="true">
                <span class="icon">üìù</span><span>Generate Laporan</span>
            </a>
            <a href="../admin/riwayat_transaksi.html" class="menu-item" data-loading="true">
                <span class="icon">üìú</span><span>Riwayat Transaksi</span>
            </a>
        </div>
        <div class="menu-section">
            <div class="menu-label">Manajemen</div>
            <a href="../admin/pengaturan.html" class="menu-item" data-loading="true">
                <span class="icon">‚öôÔ∏è</span><span>Pengaturan</span>
            </a>
           <!-- <a href="../admin/notifikasi.html" class="menu-item" data-loading="true">
                <span class="icon">üîî</span><span>Notifikasi</span>
            </a> -->
            <a href="#" class="menu-item" onclick="location.href='../pages/login.html'">
                <span class="icon">üö™</span><span>Logout</span>
            </a>
        </div>
    </aside>

<main class="main-content" id="mainContent">
    <div class="header">
        <div class="header-left">
            <h1>Barang Masuk</h1>
            <p>Kelola penerimaan barang dan stok gudang</p>
        </div>
        <div class="header-right">
            <button class="menu-toggle" id="menuToggle">‚ò∞</button>
        </div>
    </div>

    <!-- Form Input Barang Masuk -->
    <div class="form-container">
        <h2 style="color:#0c4a6e;margin-bottom:20px;font-size:18px;font-weight:800;">‚ûï Tambah Barang Masuk</h2>
        <form id="barangMasukForm" autocomplete="off">
            <div class="form-grid">
                <!-- Nama Barang with Autocomplete -->
                <div class="form-group">
                    <label for="namaBarang">Nama Barang</label>
                    <div class="autocomplete-wrapper">
                        <input type="text" id="namaBarang" placeholder="Ketik atau pilih nama barang..." required>
                        <div class="autocomplete-dropdown" id="autocompleteDropdown"></div>
                    </div>
                    <div class="autocomplete-hint">üí° Ketik untuk mencari barang terdaftar, atau ketik nama baru</div>
                </div>

                <div class="form-group">
                    <label for="kategori">Kategori</label>
                    <select id="kategori" required>
                        <option value="">Pilih kategori</option>
                        <option value="pancing">Alat Pancing</option>
                        <option value="umpan">Umpan</option>
                        <option value="aksesoris">Aksesoris</option>
                        <option value="pakaian">Pakaian</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="jumlah">Jumlah</label>
                    <input type="number" id="jumlah" placeholder="0" min="1" required>
                </div>
                <div class="form-group">
                    <label for="satuan">Satuan</label>
                    <select id="satuan" required>
                        <option value="">Pilih satuan</option>
                        <option value="pcs">Pcs</option>
                        <option value="pack">Pack</option>
                        <option value="lusin">Lusin</option>
                        <option value="kg">Kg</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="supplier">Supplier</label>
                    <select id="supplier" required>
                        <option value="">Pilih supplier</option>
                        <option value="supplier1">PT. Alat Pancing Indonesia</option>
                        <option value="supplier2">CV. Umpan Jaya</option>
                        <option value="supplier3">Toko Aksesoris Laut</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tanggalMasuk">Tanggal Masuk</label>
                    <input type="date" id="tanggalMasuk" required>
                </div>
                <div class="form-group">
                    <label for="hargaBeli">Harga Beli (Rp)</label>
                    <input type="number" id="hargaBeli" placeholder="0" min="0" required>
                </div>
                <div class="form-group">
                    <label for="hargaJual">Harga Jual (Rp)</label>
                    <input type="number" id="hargaJual" placeholder="0" min="0" required>
                </div>
            </div>
            <div class="form-actions">
                <button type="reset" class="btn btn-secondary" id="resetBtn">
                    <span>üîÑ</span> Reset
                </button>
                <button type="submit" class="btn btn-primary">
                    <span>üíæ</span> Simpan Barang Masuk
                </button>
            </div>
        </form>
    </div>

    <!-- Daftar Barang Masuk -->
    <div class="card">
        <div class="card-header">
            <h3>üìã Daftar Barang Masuk</h3>
            <div style="display:flex;gap:10px;">
                <!-- <button class="print-btn" id="printBtn">üñ®Ô∏è Cetak Laporan</button> -->
                <button class="filter-btn" id="filterToggleBtn">üîç Filter</button>
            </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar" id="filterBar">
            <div class="filter-bar-title">üîß Filter Data</div>
            <div class="filter-grid">
                <div class="filter-group">
                    <label>Dari Tanggal</label>
                    <input type="date" id="filterTanggalDari">
                </div>
                <div class="filter-group">
                    <label>Sampai Tanggal</label>
                    <input type="date" id="filterTanggalSampai">
                </div>
                <div class="filter-group">
                    <label>Kategori</label>
                    <select id="filterKategori">
                        <option value="">Semua Kategori</option>
                        <option value="pancing">Alat Pancing</option>
                        <option value="umpan">Umpan</option>
                        <option value="aksesoris">Aksesoris</option>
                        <option value="pakaian">Pakaian</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Supplier</label>
                    <select id="filterSupplier">
                        <option value="">Semua Supplier</option>
                        <option value="supplier1">PT. Alat Pancing Indonesia</option>
                        <option value="supplier2">CV. Umpan Jaya</option>
                        <option value="supplier3">Toko Aksesoris Laut</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filterStatus">
                        <option value="">Semua Status</option>
                        <option value="aman">Aman</option>
                        <option value="menipis">Menipis</option>
                        <option value="habis">Habis</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Min. Jumlah</label>
                    <input type="number" id="filterJumlahMin" placeholder="0" min="0">
                </div>
            </div>
            <div class="filter-actions">
                <button class="btn-filter-apply" id="applyFilter">‚úÖ Terapkan Filter</button>
                <button class="btn-filter-reset" id="resetFilter">üîÑ Reset Filter</button>
            </div>
        </div>

        <!-- Search -->
        <div class="search-container">
            <span class="icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Cari berdasarkan nama barang, kategori, atau supplier...">
        </div>

        <div id="resultCount" class="result-count" style="display:none;"></div>

        <!-- Table -->
        <div class="table-container">
            <div class="item-list" id="itemList">
                <div class="item-header">
                    <div>Nama Barang</div>
                    <div>Kategori</div>
                    <div>Jumlah</div>
                    <div>Harga Beli</div>
                    <div>Harga Jual</div>
                    <div>Supplier</div>
                    <div>Tgl Masuk</div>
                    <div>Status</div>
                    <div>Aksi</div>
                </div>
                <div id="tableBody"></div>
            </div>
        </div>

        <div class="pagination" id="pagination"></div>

        <div class="total-summary">
            <div>Total Ditampilkan: <strong id="totalItems">0</strong> item</div>
            <div>Total Nilai Beli: <strong id="totalValue">Rp 0</strong></div>
        </div>
    </div>
</main>

<!-- Edit Modal -->
<div class="modal" id="editModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>‚úèÔ∏è Edit Barang Masuk</h3>
            <button class="modal-close" id="closeEditModal">‚úï</button>
        </div>
        <div class="modal-body">
            <form id="editBarangForm" autocomplete="off">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nama Barang</label>
                        <input type="text" id="editNamaBarang" required>
                    </div>
                    <div class="form-group">
                        <label>Kategori</label>
                        <select id="editKategori" required>
                            <option value="">Pilih kategori</option>
                            <option value="pancing">Alat Pancing</option>
                            <option value="umpan">Umpan</option>
                            <option value="aksesoris">Aksesoris</option>
                            <option value="pakaian">Pakaian</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Jumlah</label>
                        <input type="number" id="editJumlah" min="0" required>
                    </div>
                    <div class="form-group">
                        <label>Satuan</label>
                        <select id="editSatuan" required>
                            <option value="">Pilih satuan</option>
                            <option value="pcs">Pcs</option>
                            <option value="pack">Pack</option>
                            <option value="lusin">Lusin</option>
                            <option value="kg">Kg</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Supplier</label>
                        <select id="editSupplier" required>
                            <option value="">Pilih supplier</option>
                            <option value="supplier1">PT. Alat Pancing Indonesia</option>
                            <option value="supplier2">CV. Umpan Jaya</option>
                            <option value="supplier3">Toko Aksesoris Laut</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tanggal Masuk</label>
                        <input type="date" id="editTanggalMasuk" required>
                    </div>
                    <div class="form-group">
                        <label>Harga Beli (Rp)</label>
                        <input type="number" id="editHargaBeli" min="0" required>
                    </div>
                    <div class="form-group">
                        <label>Harga Jual (Rp)</label>
                        <input type="number" id="editHargaJual" min="0" required>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelEdit">Batal</button>
            <button class="btn btn-primary" id="saveEdit">üíæ Simpan Perubahan</button>
        </div>
    </div>
</div>

<!-- Delete Modal -->
<div class="modal" id="deleteModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>üóëÔ∏è Konfirmasi Hapus</h3>
            <button class="modal-close" id="closeDeleteModal">‚úï</button>
        </div>
        <div class="modal-body">
            <p style="color:#64748b;margin-bottom:12px;">Apakah Anda yakin ingin menghapus data barang masuk ini?</p>
            <p style="font-weight:700;color:#0c4a6e;font-size:16px;" id="itemToDeleteName"></p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelDelete">Batal</button>
            <button class="btn btn-primary" style="background:linear-gradient(135deg,#f43f5e,#e11d48);" id="confirmDelete">üóëÔ∏è Hapus</button>
        </div>
    </div>
</div>

<!-- Loading -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="dots-loader">
        <div class="dots"><span></span><span></span><span></span></div>
        <p class="loading-title">Memproses...</p>
    </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
// ========================
// DATA
// ========================
const supplierMap = {
    supplier1: 'PT. Alat Pancing Indonesia',
    supplier2: 'CV. Umpan Jaya',
    supplier3: 'Toko Aksesoris Laut'
};
const kategoriMap = {
    pancing: 'Alat Pancing', umpan: 'Umpan', aksesoris: 'Aksesoris', pakaian: 'Pakaian'
};
const satuanMap = {
    pcs: 'Pcs', pack: 'Pack', lusin: 'Lusin', kg: 'Kg'
};

// Daftar nama barang terdaftar (master data)
let masterBarang = [
    { nama: 'Joran Ultralight', kategori: 'pancing' },
    { nama: 'Joran Carbon 2m', kategori: 'pancing' },
    { nama: 'Reel Spinning 3000', kategori: 'pancing' },
    { nama: 'Senar Fluorocarbon 0.3mm', kategori: 'pancing' },
    { nama: 'Umpan Pelet Ikan Mas', kategori: 'umpan' },
    { nama: 'Umpan Cacing Kering', kategori: 'umpan' },
    { nama: 'Umpan Udang Beku', kategori: 'umpan' },
    { nama: 'Kail Ukuran 10', kategori: 'aksesoris' },
    { nama: 'Kail Ukuran 8', kategori: 'aksesoris' },
    { nama: 'Pelampung Oval', kategori: 'aksesoris' },
    { nama: 'Tackle Box Medium', kategori: 'aksesoris' },
    { nama: 'Rompi Pancing', kategori: 'pakaian' },
    { nama: 'Topi Pancing UV Protection', kategori: 'pakaian' },
    { nama: 'Sarung Tangan Pancing', kategori: 'pakaian' },
];

let barangMasukData = [
    { id: 1, nama: 'Joran Ultralight', kategori: 'pancing', jumlah: 15, satuan: 'pcs', hargaBeli: 150000, hargaJual: 200000, supplier: 'supplier1', tanggalMasuk: '2023-11-12', status: 'aman' },
    { id: 2, nama: 'Umpan Pelet Ikan Mas', kategori: 'umpan', jumlah: 5, satuan: 'kg', hargaBeli: 25000, hargaJual: 35000, supplier: 'supplier2', tanggalMasuk: '2023-11-10', status: 'menipis' },
    { id: 3, nama: 'Kail Ukuran 10', kategori: 'aksesoris', jumlah: 0, satuan: 'pcs', hargaBeli: 5000, hargaJual: 8000, supplier: 'supplier3', tanggalMasuk: '2023-11-08', status: 'habis' },
    { id: 4, nama: 'Rompi Pancing', kategori: 'pakaian', jumlah: 10, satuan: 'pcs', hargaBeli: 120000, hargaJual: 180000, supplier: 'supplier1', tanggalMasuk: '2023-11-05', status: 'aman' },
    { id: 5, nama: 'Reel Spinning 3000', kategori: 'pancing', jumlah: 8, satuan: 'pcs', hargaBeli: 200000, hargaJual: 280000, supplier: 'supplier1', tanggalMasuk: '2023-11-01', status: 'aman' },
];

let nextId = 6;
let currentEditId = null;
let currentDeleteId = null;
let activeFilters = {};
let searchKeyword = '';

const ITEMS_PER_PAGE = 10;
let currentPage = 1;

// ========================
// TOAST
// ========================
function showToast(msg, type = 'success') {
    const t = document.getElementById('toast');
    t.textContent = (type === 'success' ? '‚úÖ ' : type === 'error' ? '‚ùå ' : '‚ö†Ô∏è ') + msg;
    t.className = `toast ${type} show`;
    setTimeout(() => t.classList.remove('show'), 3000);
}

// ========================
// LOADING
// ========================
function showLoading() { document.getElementById('loadingOverlay').classList.add('active'); }
function hideLoading() { document.getElementById('loadingOverlay').classList.remove('active'); }

// ========================
// FORMAT
// ========================
function formatRp(n) { return 'Rp ' + n.toLocaleString('id-ID'); }
function formatDate(d) {
    if (!d) return '-';
    const parts = d.split('-');
    const months = ['Jan','Feb','Mar','Apr','Mei','Jun','Jul','Agu','Sep','Okt','Nov','Des'];
    return `${parseInt(parts[2])} ${months[parseInt(parts[1])-1]} ${parts[0]}`;
}
function getStatus(jumlah) {
    if (jumlah <= 0) return 'habis';
    if (jumlah <= 5) return 'menipis';
    return 'aman';
}
function statusLabel(s) {
    return { aman: 'Aman', menipis: 'Menipis', habis: 'Habis' }[s] || s;
}

// ========================
// AUTOCOMPLETE
// ========================
const namaBarangInput = document.getElementById('namaBarang');
const dropdown = document.getElementById('autocompleteDropdown');

namaBarangInput.addEventListener('input', function() {
    const val = this.value.trim().toLowerCase();
    if (!val) { dropdown.classList.remove('open'); return; }

    const matched = masterBarang.filter(b => b.nama.toLowerCase().includes(val));
    const isExact = masterBarang.some(b => b.nama.toLowerCase() === val);

    let html = '';
    matched.forEach(b => {
        html += `<div class="autocomplete-item" data-nama="${b.nama}" data-kat="${b.kategori}">
            <span>üì¶</span> ${b.nama}
            <span class="item-cat">${kategoriMap[b.kategori] || b.kategori}</span>
        </div>`;
    });

    if (!isExact && this.value.trim().length >= 2) {
        html += `<div class="autocomplete-item new-item" data-nama="${this.value.trim()}" data-kat="">
            <span>‚ûï</span> Tambah baru: "<strong>${this.value.trim()}</strong>"
        </div>`;
    }

    if (!html) { dropdown.classList.remove('open'); return; }
    dropdown.innerHTML = html;
    dropdown.classList.add('open');

    dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
        item.addEventListener('click', function() {
            const nama = this.getAttribute('data-nama');
            const kat = this.getAttribute('data-kat');
            namaBarangInput.value = nama;
            if (kat) document.getElementById('kategori').value = kat;
            dropdown.classList.remove('open');

            // If new item, add to master
            if (!masterBarang.find(b => b.nama === nama)) {
                masterBarang.push({ nama, kategori: kat });
            }
        });
    });
});

document.addEventListener('click', function(e) {
    if (!e.target.closest('.autocomplete-wrapper')) {
        dropdown.classList.remove('open');
    }
});

namaBarangInput.addEventListener('focus', function() {
    if (this.value.trim().length >= 1) this.dispatchEvent(new Event('input'));
});

// ========================
// RENDER TABLE
// ========================
function getFilteredData() {
    let data = [...barangMasukData];

    // Search
    if (searchKeyword) {
        const kw = searchKeyword.toLowerCase();
        data = data.filter(d =>
            d.nama.toLowerCase().includes(kw) ||
            (kategoriMap[d.kategori] || d.kategori).toLowerCase().includes(kw) ||
            (supplierMap[d.supplier] || d.supplier).toLowerCase().includes(kw)
        );
    }

    // Filters
    if (activeFilters.tanggalDari) {
        data = data.filter(d => d.tanggalMasuk >= activeFilters.tanggalDari);
    }
    if (activeFilters.tanggalSampai) {
        data = data.filter(d => d.tanggalMasuk <= activeFilters.tanggalSampai);
    }
    if (activeFilters.kategori) {
        data = data.filter(d => d.kategori === activeFilters.kategori);
    }
    if (activeFilters.supplier) {
        data = data.filter(d => d.supplier === activeFilters.supplier);
    }
    if (activeFilters.status) {
        data = data.filter(d => d.status === activeFilters.status);
    }
    if (activeFilters.jumlahMin !== undefined && activeFilters.jumlahMin !== '') {
        data = data.filter(d => d.jumlah >= parseInt(activeFilters.jumlahMin));
    }

    return data;
}

function renderTable() {
    const filtered = getFilteredData();
    const totalPages = Math.ceil(filtered.length / ITEMS_PER_PAGE);
    if (currentPage > totalPages) currentPage = Math.max(1, totalPages);

    const start = (currentPage - 1) * ITEMS_PER_PAGE;
    const pageData = filtered.slice(start, start + ITEMS_PER_PAGE);

    const body = document.getElementById('tableBody');
    if (filtered.length === 0) {
        body.innerHTML = `<div class="empty-state">
            <span class="icon">üì≠</span>
            <p>Tidak ada data yang sesuai dengan pencarian atau filter.</p>
        </div>`;
    } else {
        body.innerHTML = pageData.map(item => `
            <div class="item-row" data-id="${item.id}">
                <div><strong>${item.nama}</strong></div>
                <div>${kategoriMap[item.kategori] || item.kategori}</div>
                <div>${item.jumlah} ${satuanMap[item.satuan] || item.satuan}</div>
                <div class="harga">${formatRp(item.hargaBeli)}</div>
                <div class="harga">${formatRp(item.hargaJual)}</div>
                <div>${supplierMap[item.supplier] || item.supplier}</div>
                <div>${formatDate(item.tanggalMasuk)}</div>
                <div><span class="status-badge ${item.status}">${statusLabel(item.status)}</span></div>
                <div class="item-actions">
                    <button class="btn-icon btn-edit" onclick="openEdit(${item.id})">‚úèÔ∏è</button>
                    <button class="btn-icon btn-delete" onclick="openDelete(${item.id})">üóëÔ∏è</button>
                </div>
            </div>
        `).join('');
    }

    // Summary
    const totalNilai = filtered.reduce((s, d) => s + (d.hargaBeli * d.jumlah), 0);
    document.getElementById('totalItems').textContent = filtered.length;
    document.getElementById('totalValue').textContent = formatRp(totalNilai);

    // Result count
    const rc = document.getElementById('resultCount');
    if (searchKeyword || Object.keys(activeFilters).some(k => activeFilters[k] !== '' && activeFilters[k] !== undefined)) {
        rc.style.display = 'inline-block';
        rc.textContent = `Menampilkan ${filtered.length} dari ${barangMasukData.length} data`;
    } else {
        rc.style.display = 'none';
    }

    renderPagination(totalPages);
}

function renderPagination(totalPages) {
    const pg = document.getElementById('pagination');
    if (totalPages <= 1) { pg.innerHTML = ''; return; }
    let html = `<button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled style="opacity:0.4"' : ''}>‚ùÆ</button>`;
    for (let i = 1; i <= totalPages; i++) {
        html += `<button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
    }
    html += `<button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled style="opacity:0.4"' : ''}>‚ùØ</button>`;
    pg.innerHTML = html;
}

function changePage(p) {
    const filtered = getFilteredData();
    const totalPages = Math.ceil(filtered.length / ITEMS_PER_PAGE);
    if (p < 1 || p > totalPages) return;
    currentPage = p;
    renderTable();
}

// ========================
// SEARCH
// ========================
document.getElementById('searchInput').addEventListener('input', function() {
    searchKeyword = this.value.trim();
    currentPage = 1;
    renderTable();
});

// ========================
// FILTER
// ========================
document.getElementById('filterToggleBtn').addEventListener('click', function() {
    document.getElementById('filterBar').classList.toggle('open');
});

document.getElementById('applyFilter').addEventListener('click', function() {
    activeFilters = {
        tanggalDari: document.getElementById('filterTanggalDari').value,
        tanggalSampai: document.getElementById('filterTanggalSampai').value,
        kategori: document.getElementById('filterKategori').value,
        supplier: document.getElementById('filterSupplier').value,
        status: document.getElementById('filterStatus').value,
        jumlahMin: document.getElementById('filterJumlahMin').value,
    };
    currentPage = 1;
    renderTable();
    showToast('Filter diterapkan!', 'success');
});

document.getElementById('resetFilter').addEventListener('click', function() {
    document.getElementById('filterTanggalDari').value = '';
    document.getElementById('filterTanggalSampai').value = '';
    document.getElementById('filterKategori').value = '';
    document.getElementById('filterSupplier').value = '';
    document.getElementById('filterStatus').value = '';
    document.getElementById('filterJumlahMin').value = '';
    activeFilters = {};
    currentPage = 1;
    renderTable();
    showToast('Filter direset', 'warning');
});

// ========================
// FORM SUBMIT (ADD)
// ========================
document.getElementById('barangMasukForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const nama = document.getElementById('namaBarang').value.trim();
    const kategori = document.getElementById('kategori').value;
    const jumlah = parseInt(document.getElementById('jumlah').value);
    const satuan = document.getElementById('satuan').value;
    const supplier = document.getElementById('supplier').value;
    const tanggalMasuk = document.getElementById('tanggalMasuk').value;
    const hargaBeli = parseInt(document.getElementById('hargaBeli').value);
    const hargaJual = parseInt(document.getElementById('hargaJual').value);

    if (!nama || !kategori || !jumlah || !satuan || !supplier || !tanggalMasuk || !hargaBeli || !hargaJual) {
        showToast('Harap lengkapi semua field!', 'error'); return;
    }

    showLoading();
    setTimeout(() => {
        hideLoading();
        const newItem = {
            id: nextId++,
            nama, kategori, jumlah, satuan, supplier, tanggalMasuk, hargaBeli, hargaJual,
            status: getStatus(jumlah)
        };
        barangMasukData.unshift(newItem);

        // Add to master if new
        if (!masterBarang.find(b => b.nama === nama)) {
            masterBarang.push({ nama, kategori });
        }

        document.getElementById('barangMasukForm').reset();
        document.getElementById('tanggalMasuk').valueAsDate = new Date();
        currentPage = 1;
        renderTable();
        showToast(`Barang "${nama}" berhasil ditambahkan!`, 'success');
    }, 1000);
});

document.getElementById('resetBtn').addEventListener('click', function() {
    setTimeout(() => { document.getElementById('tanggalMasuk').valueAsDate = new Date(); }, 10);
});

// ========================
// EDIT
// ========================
function openEdit(id) {
    const item = barangMasukData.find(d => d.id === id);
    if (!item) return;
    currentEditId = id;
    document.getElementById('editNamaBarang').value = item.nama;
    document.getElementById('editKategori').value = item.kategori;
    document.getElementById('editJumlah').value = item.jumlah;
    document.getElementById('editSatuan').value = item.satuan;
    document.getElementById('editSupplier').value = item.supplier;
    document.getElementById('editTanggalMasuk').value = item.tanggalMasuk;
    document.getElementById('editHargaBeli').value = item.hargaBeli;
    document.getElementById('editHargaJual').value = item.hargaJual;
    document.getElementById('editModal').classList.add('active');
}

function closeEditModal() {
    document.getElementById('editModal').classList.remove('active');
    currentEditId = null;
}

document.getElementById('closeEditModal').addEventListener('click', closeEditModal);
document.getElementById('cancelEdit').addEventListener('click', closeEditModal);

document.getElementById('saveEdit').addEventListener('click', function() {
    if (!currentEditId) return;
    const jumlah = parseInt(document.getElementById('editJumlah').value);
    showLoading();
    setTimeout(() => {
        hideLoading();
        const idx = barangMasukData.findIndex(d => d.id === currentEditId);
        if (idx >= 0) {
            barangMasukData[idx] = {
                ...barangMasukData[idx],
                nama: document.getElementById('editNamaBarang').value.trim(),
                kategori: document.getElementById('editKategori').value,
                jumlah,
                satuan: document.getElementById('editSatuan').value,
                supplier: document.getElementById('editSupplier').value,
                tanggalMasuk: document.getElementById('editTanggalMasuk').value,
                hargaBeli: parseInt(document.getElementById('editHargaBeli').value),
                hargaJual: parseInt(document.getElementById('editHargaJual').value),
                status: getStatus(jumlah)
            };
        }
        closeEditModal();
        renderTable();
        showToast('Data berhasil diperbarui!', 'success');
    }, 800);
});

// ========================
// DELETE
// ========================
function openDelete(id) {
    const item = barangMasukData.find(d => d.id === id);
    if (!item) return;
    currentDeleteId = id;
    document.getElementById('itemToDeleteName').textContent = item.nama;
    document.getElementById('deleteModal').classList.add('active');
}

function closeDeleteModal() {
    document.getElementById('deleteModal').classList.remove('active');
    currentDeleteId = null;
}

document.getElementById('closeDeleteModal').addEventListener('click', closeDeleteModal);
document.getElementById('cancelDelete').addEventListener('click', closeDeleteModal);

document.getElementById('confirmDelete').addEventListener('click', function() {
    if (!currentDeleteId) return;
    showLoading();
    setTimeout(() => {
        hideLoading();
        const item = barangMasukData.find(d => d.id === currentDeleteId);
        barangMasukData = barangMasukData.filter(d => d.id !== currentDeleteId);
        closeDeleteModal();
        renderTable();
        showToast(`"${item?.nama}" berhasil dihapus!`, 'error');
    }, 700);
});

// ========================
// PRINT
// ========================
// document.getElementById('printBtn').addEventListener('click', function() {
//     showLoading();
//     setTimeout(() => { hideLoading(); window.print(); }, 800);
// });

// ========================
// SIDEBAR TOGGLE
// ========================
document.getElementById('menuToggle').addEventListener('click', function() {
    document.getElementById('sidebar').classList.toggle('active');
    document.getElementById('overlay').classList.toggle('active');
});
document.getElementById('overlay').addEventListener('click', function() {
    document.getElementById('sidebar').classList.remove('active');
    this.classList.remove('active');
});

// ========================
// INIT
// ========================
document.getElementById('tanggalMasuk').valueAsDate = new Date();
renderTable();
</script>
</body>
</html>